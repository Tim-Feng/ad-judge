<% if logged_in? %>
   <div id="fb_share_<%=post.id%>" class="social_share_column" >
     <%= image_tag("facebook_share.png", alt: "share", size: "108x40") %>
  </div>  
<% else %>
  <div class="social_share_column">
    <%= link_to image_tag("facebook_share.png", alt: "login", size: "108x40"), login_path %>
  </div>
<% end %>

<script>
  $(document).on('click','#fb_share_<%= post.id %>', function(){
    $("meta[property='og:url']").remove();
    $('head').append( '<meta property="og:url" content="http://www.ad-judge.com/posts/<%= post.slug.gsub("/vote","") %>" />' );
    $("meta[property='og:title']").remove();
    $('head').append( '<meta property="og:title" content="<%= post.title %>" />' );
    $("meta[property='og:type']").remove();
    $('head').append( '<meta property="og:type" content="article" />' );
    $("meta[property='og:description']").remove();
    $('head').append( '<meta property="og:description" content="<%= post.title %>" />' );
    $("meta[property='og:image']").remove();
    $('head').append( '<meta property="og:image" content="http://img.youtube.com/vi/<%= post.youtube_video_id %>/hqdefault.jpg" />' );
    FB.ui({
      method: 'share_open_graph',
      action_type: 'og.shares',
      action_properties: JSON.stringify({
          object:'http://www.ad-judge.com/posts/<%= post.slug %>',
      })
    }, function(response){});
  });
</script>